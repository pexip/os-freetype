Description: Validate first and last character code fields
Origin: upstream, http://git.savannah.gnu.org/cgit/freetype/freetype2.git/commit/?id=7d35a7dc7cc621538a1f4a63c83ebf223aace0b0

Index: freetype-2.4.8/src/winfonts/winfnt.c
===================================================================
--- freetype-2.4.8.orig/src/winfonts/winfnt.c	2010-09-11 01:06:45.000000000 -0500
+++ freetype-2.4.8/src/winfonts/winfnt.c	2012-03-20 15:48:19.604374979 -0500
@@ -827,7 +827,14 @@
           root->charmap = root->charmaps[0];
       }
 
-      /* setup remaining flags */
+      /* set up remaining flags */
+
+      if ( font->header.last_char < font->header.first_char )
+      {
+        FT_TRACE2(( "invalid number of glyphs\n" ));
+        error = FNT_Err_Invalid_File_Format;
+        goto Fail;
+      }
 
       /* reserve one slot for the .notdef glyph at index 0 */
       root->num_glyphs = font->header.last_char -
