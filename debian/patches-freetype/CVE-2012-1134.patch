Description: Ensure dictionaries meet minimum size requirements
Origin: upstream, http://git.savannah.gnu.org/cgit/freetype/freetype2.git/commit/?id=d9577add645c8c05460c7d60ad486c021394b82e

Index: freetype-2.4.8/src/type1/t1parse.c
===================================================================
--- freetype-2.4.8.orig/src/type1/t1parse.c	2009-11-25 16:46:15.000000000 -0600
+++ freetype-2.4.8/src/type1/t1parse.c	2012-03-20 15:44:57.984370190 -0500
@@ -467,6 +467,14 @@
     /* we now decrypt the encoded binary private dictionary */
     psaux->t1_decrypt( parser->private_dict, parser->private_len, 55665U );
 
+    if ( parser->private_len < 4 )
+    {
+      FT_ERROR(( "T1_Get_Private_Dict:"
+                 " invalid private dictionary section\n" ));
+      error = T1_Err_Invalid_File_Format;
+      goto Fail;
+    }
+
     /* replace the four random bytes at the beginning with whitespace */
     parser->private_dict[0] = ' ';
     parser->private_dict[1] = ' ';
