Backport of:

From 35252ae9aa1dd9343e9f4884e9ddb1fee10ef415 Mon Sep 17 00:00:00 2001
From: suzuki toshiya <mpsuzuki@hiroshima-u.ac.jp>
Date: Wed, 26 Nov 2014 06:52:23 +0000
Subject: Fix Savannah bug #43539.

* src/base/ftobjs.c (Mac_Read_POST_Resource): Fix integer overflow
by a broken POST table in resource-fork.

Also includes:

http://git.savannah.gnu.org/cgit/freetype/freetype2.git/commit/src/base/ftobjs.c?id=5aff85301bdce7677766fa1367c82ff41a739637

---
Index: freetype-2.4.8/src/base/ftobjs.c
===================================================================
--- freetype-2.4.8.orig/src/base/ftobjs.c	2015-02-24 10:24:43.501199846 -0500
+++ freetype-2.4.8/src/base/ftobjs.c	2015-02-24 10:26:50.298302479 -0500
@@ -1583,9 +1583,14 @@
       if ( error )
         goto Exit2;
       if ( FT_READ_LONG( rlen ) )
-        goto Exit;
+        goto Exit2;
+      if ( rlen < 0 )
+      {
+        error = FT_Err_Invalid_Offset;
+        goto Exit2;
+      }
       if ( FT_READ_USHORT( flags ) )
-        goto Exit;
+        goto Exit2;
       FT_TRACE3(( "POST fragment[%d]: offsets=0x%08x, rlen=0x%08x, flags=0x%04x\n",
                    i, offsets[i], rlen, flags ));
 
@@ -1601,7 +1606,14 @@
         rlen = 0;
 
       if ( ( flags >> 8 ) == type )
+      {
+        if ( 0x7FFFFFFFL - rlen < len )
+        {
+          error = FT_Err_Array_Too_Large;
+          goto Exit2;
+        }
         len += rlen;
+      }
       else
       {
         if ( pfb_lenpos + 3 > pfb_len + 2 )
@@ -1630,6 +1642,11 @@
       }
 
       error = FT_Err_Cannot_Open_Resource;
+      if ( rlen > 0x7FFFFFFFL - pfb_pos )
+      {
+        error = FT_Err_Array_Too_Large;
+        goto Exit2;
+      }
       if ( pfb_pos > pfb_len || pfb_pos + rlen > pfb_len )
         goto Exit2;
 
