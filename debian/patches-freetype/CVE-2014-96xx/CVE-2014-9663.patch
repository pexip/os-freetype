Backport of:

From 9bd20b7304aae61de5d50ac359cf27132bafd4c1 Mon Sep 17 00:00:00 2001
From: Werner Lemberg <wl@gnu.org>
Date: Sat, 22 Nov 2014 05:24:45 +0000
Subject: [sfnt] Fix Savannah bug #43656.

* src/sfnt/ttcmap.c (tt_cmap4_validate): Fix order of validity
tests.
---
Index: freetype-2.4.8/src/sfnt/ttcmap.c
===================================================================
--- freetype-2.4.8.orig/src/sfnt/ttcmap.c	2015-02-24 10:03:07.162101891 -0500
+++ freetype-2.4.8/src/sfnt/ttcmap.c	2015-02-24 10:03:07.158101860 -0500
@@ -815,9 +815,6 @@
     FT_Error  error = SFNT_Err_Ok;
 
 
-    if ( length < 16 )
-      FT_INVALID_TOO_SHORT;
-
     /* in certain fonts, the `length' field is invalid and goes */
     /* out of bound.  We try to correct this here...            */
     if ( table + length > valid->limit )
@@ -828,6 +825,9 @@
       length = (FT_UInt)( valid->limit - table );
     }
 
+    if ( length < 16 )
+      FT_INVALID_TOO_SHORT;
+
     p        = table + 6;
     num_segs = TT_NEXT_USHORT( p );   /* read segCountX2 */
 
