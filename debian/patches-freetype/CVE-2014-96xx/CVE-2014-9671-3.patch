Backport of:

From 06842c7b49c21f13c0ab61201daab6ff5a358fcc Mon Sep 17 00:00:00 2001
From: Werner Lemberg <wl@gnu.org>
Date: Sat, 13 Dec 2014 06:42:51 +0000
Subject: * src/pcf/pcfread.c (pcf_read_TOC): Improve fix from 2014-12-08.

---
Index: freetype-2.4.8/src/pcf/pcfread.c
===================================================================
--- freetype-2.4.8.orig/src/pcf/pcfread.c	2015-02-24 10:24:09.628904580 -0500
+++ freetype-2.4.8/src/pcf/pcfread.c	2015-02-24 10:24:09.624904545 -0500
@@ -190,14 +190,15 @@
       tables++;
     }
 
-    /* no check of `tables->size' for last table element ... */
+    /* only check `tables->offset' for last table element ... */
     if ( ( tables->offset > size ) )
     {
       error = PCF_Err_Invalid_Table;
       goto Exit;
     }
-    /* ... instead, we adjust `tables->size' to the real value */
-    tables->size = size - tables->offset;
+    /* ... and adjust `tables->size' to the real value if necessary */
+    if ( tables->size > size - tables->offset )
+      tables->size = size - tables->offset;
 
 #ifdef FT_DEBUG_LEVEL_TRACE
 
