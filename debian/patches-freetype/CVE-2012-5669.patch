Description: fix denial of service and possible code execution via heap
 buffer over-read in BDF parsing
Origin: upstream, http://git.savannah.gnu.org/cgit/freetype/freetype2.git/commit/?id=07bdb6e289c7954e2a533039dc93c1c136099d2d
Bug: https://savannah.nongnu.org/bugs/?37906
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=696691

Index: freetype-2.4.8/src/bdf/bdflib.c
===================================================================
--- freetype-2.4.8.orig/src/bdf/bdflib.c	2013-01-11 13:49:30.000000000 -0500
+++ freetype-2.4.8/src/bdf/bdflib.c	2013-01-11 13:50:22.407209080 -0500
@@ -1602,8 +1602,9 @@
 
       /* Check that the encoding is in the range [0,65536] because */
       /* otherwise p->have (a bitmap with static size) overflows.  */
-      if ( p->glyph_enc > 0                               &&
-           (size_t)p->glyph_enc >= sizeof ( p->have ) * 8 )
+      if ( p->glyph_enc > 0                                      &&
+           (size_t)p->glyph_enc >= sizeof ( p->have ) /
+                                   sizeof ( unsigned long ) * 32 )
       {
         error = BDF_Err_Invalid_File_Format;
         goto Exit;
