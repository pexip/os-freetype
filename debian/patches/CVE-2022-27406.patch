Description: Guard the `face->size` handle before attempting to read its value
 (CVE-2022-27406).
Author: Werner Lemberg
Origin: https://gitlab.freedesktop.org/freetype/freetype/-/commit/0c2bdb01a2e1d24a3e592377a6d0822856e10df2
Bug: https://gitlab.freedesktop.org/freetype/freetype/-/issues/1140
Bug-Debian: https://bugs.debian.org/1010183
Last-Update: 2022-04-28

--- a/src/base/ftobjs.c
+++ b/src/base/ftobjs.c
@@ -3274,6 +3274,9 @@
     if ( !face )
       return FT_THROW( Invalid_Face_Handle );
 
+    if ( !face->size )
+      return FT_THROW( Invalid_Size_Handle );
+
     if ( !req || req->width < 0 || req->height < 0 ||
          req->type >= FT_SIZE_REQUEST_TYPE_MAX )
       return FT_THROW( Invalid_Argument );
