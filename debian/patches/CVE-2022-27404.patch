Description: Check `face_index` before decrementing to prevent heap buffer
 overflow (CVE-2022-27404).
Author: Werner Lemberg
Origin: https://gitlab.freedesktop.org/freetype/freetype/-/commit/53dfdcd8198d2b3201a23c4bad9190519ba918db
Bug: https://gitlab.freedesktop.org/freetype/freetype/-/issues/1138
Bug-Debian: https://bugs.debian.org/1010183
Last-Update: 2022-04-28

--- a/src/sfnt/sfobjs.c
+++ b/src/sfnt/sfobjs.c
@@ -923,7 +923,7 @@
     face_index = FT_ABS( face_instance_index ) & 0xFFFF;
 
     /* value -(N+1) requests information on index N */
-    if ( face_instance_index < 0 )
+    if ( face_instance_index < 0 && face_index > 0 )
       face_index--;
 
     if ( face_index >= face->ttc_header.count )
